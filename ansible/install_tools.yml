---
- name: Configure EC2 instance (Golden AMI)
  hosts: all
  become: yes

  vars:
    tools_to_install: []

  tasks:

  - name: Gather facts
    ansible.builtin.setup:

  - name: Show tools to install
    ansible.builtin.debug:
      msg: "Tools requested: {{ tools_to_install | default([]) }}"

  - name: Ensure apt cache is up to date
    ansible.builtin.apt:
      update_cache: yes
      cache_valid_time: 3600

  - name: Install requested tools
    ansible.builtin.apt:
      name: "{{ tools_to_install }}"
      state: present
    when: tools_to_install | length > 0

  - name: Final message
    ansible.builtin.debug:
      msg: |
        EC2 configuration finished.
        Golden AMI assumed (desktop & DCV already installed).

